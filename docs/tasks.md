# SIPssert Testing Framework Tasks

Tasks are probably the most important asset of the testing framework, as they
control the applications that are being executed in order to verify your setup.
On a high level perspective, the purpose of tasks is to simplify the control of
the underlying application by providing a control interface in the scenario. At
low level, a task is essentially translated to a docker container that is run
with specifically configured parameters/settings.

In the scenario, you specify a list of tasks. Each task defined should have a
`type` node (if missing, `generic` is assumed). This value identifies the task
type that should be run. For each task, multiple settings can be defined: part
of them are generic tasks settings (as described in the [Settings](#settings)
section), and part are tasks specifics. Each specific task's settings should be
documented in the [tasks](tasks) directory.

## Execution

The way tasks are executed by the framework is described in the
[Execution](execution.md) page.

## Settings

Each task, regardless of its type, can contain one of the settings. Most of
these settings are interpreted by the testing framework itself, but they can be
inherited by the tasks as well. The generic settings are found below. Note that
only the `name` node is mandatory, all the others are optional.

* `name`: mandatory, represents the name of the task, which should be unique
among the scenario.
* `type`: the task type, which indicates how the task should be executed. if
missing, the `generic` type is assumed. Available tasks type can be found in
the [tasks](tasks) directory.
* `image`: the Docker image that should be used to run this task; if missing,
the image declared in the specific task's implementation is used; if there is
no image defined in the task (such as for the `generic` case), the execution
will fail.
* `network`: a valid network's name, as defined in the tests set
[networks](config/tests-set.md#networks) settings; if missing, the scenario's
`network` configuration is used
* `require`: defines the dependencies the task requires to execute, as
described in the [dependencies](dependencies.md) page; if missing, no
dependencies are used.
* `ready`: defines the dependencies that the task needs to satisfy in order to
become `ready`; the format is the same on as for the
[dependencies](dependencies.md); if missing, the task is ready immediately
after started.
* `delay_start`: a shortcut of the [Wait](dependencies.md#wait) dependency,
delays the start of this task with the number of seconds after the previous
task has been executed; deprecated, please use the [Wait](dependencies.md#wait)
dependency instead.
* `mount_point`: a path representing the mount point of the scenario directory;
defaults in the `/home` directory of the container, but may be overwritten by
the task implementation.
* `daemon`: boolean value, indicating whether the task should be considered a
`daemon` or a `non-daemon`; the default value is false, but it is usually
overwritten by the specific task implementation.
* `label`: a string that can be assigned to the task, that can be used later on
to reference it in the dependencies of a different task; if missing, no label
is defined and the task can only be identified by its name
* `labels`: a list of labels, with the same meaning of the single `label`
* `ip`: the IP address that should be assigned to the container when running in
the `bridge` network mode; if missing, a random IP within the range is assigned
* `ports`: the port address that should be opened for the container when
running in `bridge` network mode; if missing, no port forwarding is created
* `extra_params`: a string containing extra parameters that should be sent when
starting the container; these parameters are appended after the arguments
generated by the task implementation; if missing, no extra parameters are
used.

You can find the specific settings for each task type in their corresponding
file in the  [tasks](tasks) directory.

## Examples

Running OpenSIPS server with a specific IP and port from the `osbr0` device and
a custom configuration file in `/tmp/opensips.cfg`, and an extra memory modifier.

```
network: osbr0
tasks:
  - name: OpenSIPS
    type: opensips
    ip: 192.168.52.52
    port: 5060
    config_file: /tmp/opensips.cfg
    extra_params: -M32
```
